<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE 4-0 | The Grove Newcastle</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&family=Oswald:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="hero">
        <div id="hero-drop" class="droppable-area" ondrop="dropHandler(event, this)" ondragover="dragOverHandler(event)">
            <img src="images/hero-background.png" alt="The Grove" class="uploaded-img">
            <div class="drop-instruction" style="display: none;">Drag & Drop<br>Hero Image Here</div>
        </div>
        
        <div class="hero-overlay"></div>

        <div class="hero-content container">
            <p data-date-format="hero">Loading...</p>
            <h1>THE BIG <span class="highlight">4-0</span><br>WEEKENDER</h1>
            
            <div class="countdown" id="countdown"></div>
            <a href="#rsvp" class="btn">Gan On Then, RSVP</a>
        </div>
    </header>

    <section class="vibe">
        <div class="container vibe-grid">
            <div class="vibe-text">
                <h2>The <span class="highlight">Location</span></h2>
                <p>We are taking over the <strong>Cocktail Bar & Terrace at The Grove</strong>. Where Byker meets the Ouseburn.</p>
                <p>Industrial chic. Exposed brick. Private rooftop terrace for the sunset. This is a sophisticated rager, not a quiet pint.</p>
                <ul>
                    <li>Private Rooftop Terrace</li>
                    <li>Premium Cocktail Bar</li>
                    <li>Industrial Warehouse Aesthetic</li>
                    <li>Capacity: 80 Guests</li>
                </ul>
            </div>
            <div class="vibe-img-container droppable-area" ondrop="dropHandler(event, this)" ondragover="dragOverHandler(event)">
                <img src="images/venue-terrace.png" alt="Rooftop Terrace" class="uploaded-img">
                <div class="drop-instruction" style="display: none;">Drag Venue/Terrace Image Here</div>
            </div>
        </div>
    </section>

    <section class="hosts">
        <div class="container">
            <h2>The <span class="highlight">Architects</span></h2>
            <div class="hosts-grid">
                <div class="host-card">
                    <div class="droppable-area" ondrop="dropHandler(event, this)" ondragover="dragOverHandler(event)">
                        <img src="images/architect-1.png" alt="Birthday Boy Portrait" class="uploaded-img">
                        <div class="drop-instruction" style="display: none;">Drag Individual<br>Portrait Here</div>
                    </div>
                    <h3>The Birthday Boy</h3>
                </div>
                <div class="host-card">
                    <div class="droppable-area" ondrop="dropHandler(event, this)" ondragover="dragOverHandler(event)">
                        <img src="images/architect-2.png" alt="Birthday Boy Portrait" class="uploaded-img">
                        <div class="drop-instruction" style="display: none;">Drag Individual<br>Portrait Here</div>
                    </div>
                    <h3>The Other One</h3>
                </div>
            </div>
        </div>
    </section>

    <section class="split-section">
        <div class="split-img-container droppable-area" ondrop="dropHandler(event, this)" ondragover="dragOverHandler(event)">
            <img src="images/pizza-food.jpg" alt="Byker Slice Pizza" class="uploaded-img">
            <div class="drop-instruction" style="display: none;">Drag Food/Pizza Image Here</div>
        </div>
        <div class="split-content">
            <h2>The <span class="highlight">Fuel</span></h2>
            <p>No sit-down dinners. No boring speeches.</p>
            <p>We've partnered with <strong>Byker Slice</strong> to sling gourmet rustic pizzas, flanked by The Grove's premium cocktail menu.</p>
            <p><strong>The Bar:</strong> Open Tab. Signature Cocktails.</p>
        </div>
    </section>

    <section class="split-section">
        <div class="split-content" style="background: #111;">
            <h2>The <span class="highlight">Soundtrack</span></h2>
            <p>Nee boring tunes. From sunset soul on the terrace to industrial beats inside.</p>
            <p><strong>Timeline:</strong><br>17:00 - Terrace Vibes<br>20:00 - Volume Up<br>23:00 - Lights Out</p>
        </div>
        <div class="split-img-container droppable-area" ondrop="dropHandler(event, this)" ondragover="dragOverHandler(event)">
            <img src="images/dj-party.png" alt="DJ Setup" class="uploaded-img">
            <div class="drop-instruction" style="display: none;">Drag DJ/Party Image Here</div>
        </div>
    </section>

    <section class="rsvp" id="rsvp">
        <div class="container">
            <h2>ARE YOU IN?</h2>
            <p class="rsvp-subtitle" data-date-format="rsvp">Loading...</p>
            <form name="rsvp-form" class="rsvp-form">
                <input type="text" name="Name" placeholder="Your Full Name" required>
                <input type="email" name="Email" placeholder="Your Email (optional, but helpful for updates)">
                <select name="Response" required>
                    <option value="" disabled selected>Are you in?</option>
                    <option value="Hell yes">Hell yes, I'm there.</option>
                    <option value="Can't make it">Sadly, I can't make it.</option>
                </select>
                <input type="text" name="Song Request" placeholder="Music Request (one track that guarantees you dance)">
                
                <label class="consent-checkbox">
                    <input type="checkbox" name="Consent" required>
                    <span>Save my deets (we'll keep them as stealthily as your 3h 'dog walk' at 9pm) <span class="info-icon" title="Your info is sent via encrypted HTTPS to Google Sheets and stored securely. We'll only use it for this event.">ⓘ</span></span>
                </label>
                
                <button type="submit" class="btn">Confirm RSVP</button>
            </form>
        </div>
    </section>

    <footer class="site-footer">
        <div class="container">
            <p>Invite-only at <a href="https://www.thegrovenewcastle.co.uk/" target="_blank" rel="noopener">The Grove, Newcastle</a></p>
            <p class="footer-date" data-date-format="footer">Loading...</p>
        </div>
    </footer>

    <script>
        // --- EVENT CONFIGURATION (Single Source of Truth) ---
        const EVENT_CONFIG = {
            date: new Date('2026-05-24T17:00:00'), // ISO 8601 format for consistency
            venue: 'Newcastle upon Tyne',
            location: 'Cocktail Bar & Terrace'
        };

        // --- DATE FORMATTING UTILITIES ---
        function formatEventDate(format) {
            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            };
            
            switch(format) {
                case 'hero': // "SUNDAY MAY 24, 2026 // THE GROVE // NEWCASTLE UPON TYNE"
                    return `${EVENT_CONFIG.date.toLocaleDateString('en-US', { weekday: 'long' }).toUpperCase()} ${EVENT_CONFIG.date.toLocaleDateString('en-US', { month: 'long' }).toUpperCase()} ${EVENT_CONFIG.date.getDate()}, ${EVENT_CONFIG.date.getFullYear()} // THE GROVE // NEWCASTLE UPON TYNE`;
                
                case 'rsvp': // "May 24, 2026. Guestlist locked to 80."
                    return EVENT_CONFIG.date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }) + '. Guestlist locked to 80.';
                
                case 'footer': // "Sunday, May 24, 2026 • Cocktail Bar & Terrace"
                    return `${EVENT_CONFIG.date.toLocaleDateString('en-US', options)} • ${EVENT_CONFIG.location}`;
                
                default:
                    return EVENT_CONFIG.date.toLocaleDateString('en-US', options);
            }
        }

        // --- INITIALIZE DATE DISPLAYS ---
        document.addEventListener('DOMContentLoaded', function() {
            // Update hero date
            const heroDate = document.querySelector('.hero-content p');
            if (heroDate) heroDate.textContent = formatEventDate('hero');
            
            // Update RSVP subtitle
            const rsvpDate = document.querySelector('.rsvp-subtitle');
            if (rsvpDate) rsvpDate.textContent = formatEventDate('rsvp');
            
            // Update footer date
            const footerDate = document.querySelector('.footer-date');
            if (footerDate) footerDate.textContent = formatEventDate('footer');
        });

        // --- COUNTDOWN LOGIC ---
        var countDownDate = EVENT_CONFIG.date.getTime();
        var x = setInterval(function() {
            var now = new Date().getTime();
            var distance = countDownDate - now;
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            document.getElementById("countdown").innerHTML = 
                `<div class="time-unit"><span class="time-val">${days}</span><span class="time-label">Days</span></div>` +
                `<div class="time-unit"><span class="time-val">${hours}</span><span class="time-label">Hours</span></div>` +
                `<div class="time-unit"><span class="time-val">${minutes}</span><span class="time-label">Mins</span></div>` +
                `<div class="time-unit"><span class="time-val">${seconds}</span><span class="time-label">Secs</span></div>`;

            if (distance < 0) { clearInterval(x); document.getElementById("countdown").innerHTML = "PARTY TIME"; }
        }, 1000);

        // --- DRAG AND DROP LOGIC ---
        function dragOverHandler(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.add('drag-over');
        }

        function dropHandler(ev, el) {
            ev.preventDefault();
            el.classList.remove('drag-over');

            if (ev.dataTransfer.items) {
                [...ev.dataTransfer.items].forEach((item, i) => {
                    if (item.kind === 'file') {
                        const file = item.getAsFile();
                        const reader = new FileReader();
                        
                        reader.onload = function(e) {
                            // Check if image already exists, if so replace src, else create it
                            let img = el.querySelector('img.uploaded-img');
                            if (!img) {
                                img = document.createElement('img');
                                img.classList.add('uploaded-img');
                                el.appendChild(img);
                            }
                            img.src = e.target.result;
                            
                            // Hide instruction text
                            const text = el.querySelector('.drop-instruction');
                            if(text) text.style.display = 'none';
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }
        
        // Add "leave" event to remove hover style
        document.querySelectorAll('.droppable-area').forEach(area => {
            area.addEventListener('dragleave', () => area.classList.remove('drag-over'));
        });

        // --- CUSTOM VALIDATION MESSAGES ---
        document.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.querySelector('input[name="Name"]');
            const responseSelect = document.querySelector('select[name="Response"]');
            const consentCheckbox = document.querySelector('input[name="Consent"]');
            
            if (nameInput) {
                nameInput.addEventListener('invalid', function() {
                    this.setCustomValidity('Howay man, fill this in like');
                });
                nameInput.addEventListener('input', function() {
                    this.setCustomValidity('');
                });
            }
            
            if (responseSelect) {
                responseSelect.addEventListener('invalid', function() {
                    this.setCustomValidity('Howay man, fill this in like');
                });
                responseSelect.addEventListener('change', function() {
                    this.setCustomValidity('');
                });
            }
            
            if (consentCheckbox) {
                consentCheckbox.addEventListener('invalid', function() {
                    this.setCustomValidity('Divvent skip this one pet');
                });
                consentCheckbox.addEventListener('change', function() {
                    this.setCustomValidity('');
                });
            }
        });

        // --- GOOGLE SHEETS RSVP INTEGRATION ---
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxTNNcJTp-t29m0_BxcX0oI1_oNvwSbHP56IwlXMDhUZt8UX5CO-DgqkG3KP-U8cimP/exec';
        const form = document.forms['rsvp-form'];

        form.addEventListener('submit', e => {
            e.preventDefault();
            
            // Visual feedback: Change button text
            const submitBtn = form.querySelector('button');
            const originalBtnText = submitBtn.innerText;
            submitBtn.innerText = "LOCKING IT IN...";
            submitBtn.disabled = true; // Prevent double-submission

            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => response.json())
                .then(data => {
                    // SUCCESS!
                    form.reset(); 
                    alert("Mint! You're on the list. See you in the Ouseburn.");
                    submitBtn.innerText = originalBtnText;
                    submitBtn.disabled = false;
                })
                .catch(error => {
                    // ERROR
                    console.error('Error!', error.message);
                    alert("Ah man, that's not worked. Try again or give us a shout.");
                    submitBtn.innerText = originalBtnText;
                    submitBtn.disabled = false;
                });
        });
    </script>
</body>
</html>
